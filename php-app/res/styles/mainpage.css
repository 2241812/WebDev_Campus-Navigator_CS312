/**
 * mainpage.css
 */

/* --- Base & Container Styles --- */
body {
    font-family: 'Inter', sans-serif;
}

#mapContainer {
    transition: opacity 0.5s ease-in-out;
    position: relative;
    background-color: #1a202c; /* Ensure dark background behind map */
}

/* --- Node Base & State Styles --- */
.node {
    transition: all 0.2s ease;
    cursor: pointer;
}

.node:hover,
.node.draggable:hover {
    stroke: #38b2ac;
    stroke-width: 4;
}

.node.draggable {
    cursor: move;
}

/* State: Node is part of the final path */
.highlight {
    fill: #68d391;
    stroke: #f0fff4;
    stroke-width: 2;
}

/* State: Node is selected for an admin action */
.selected-for-action {
    stroke: #f6ad55;
    stroke-width: 4;
    stroke-dasharray: 5, 5;
    animation: pulsing-stroke 2s infinite linear;
}

/* State: Node is part of a route step being hovered */
.step-highlight {
    stroke: #F6AD55;
    stroke-width: 5px;
    fill: #F6AD55;
    animation: pulsing-stroke 1.5s infinite linear;
}

/* State: Start Node */
.node.start-node-selected {
    stroke: #000000;
    stroke-width: 4;
    fill: #71f257;
}

/* State: End Node */
.node.end-node-selected {
    stroke: #000000;
    stroke-width: 4;
    fill: #bf0404;
}

/* --- Node Type Styles --- */
circle.room {
    fill: #677ca0;
    stroke: #E2E8F0;
}

.hallway {
    fill: #a0aec0;
    stroke: #718096;
}

.stairs {
    fill: #63b3ed;
    stroke: #e2e8f0;
}

.elevator {
    fill: #f6ad55;
    stroke: #e2e8f0;
}

.elevator-employee {
    fill: #dd6b20;
    stroke: #e2e8f0;
}

/* --- Node Label Styles --- */
.node-label {
    fill: #e2e8f0; /* Lighter text for dark mode */
    font-size: 11px;
    font-weight: 600;
    text-anchor: middle;
    user-select: none;
    -webkit-user-select: none;
    text-shadow: 0px 1px 2px rgba(0,0,0,0.8);
    pointer-events: none;
}

/* --- Pathfinding Styles --- */
.path {
    stroke-width: 6px;
    stroke: #68d391;
    stroke-opacity: 0.9;
    fill: none;
    stroke-linecap: round;
    stroke-linejoin: round;
    animation: dash 1.5s linear forwards;
    filter: drop-shadow(0px 2px 3px rgba(0,0,0,0.5));
    pointer-events: none;
}

/* --- Dragging States --- */
body.is-dragging {
    cursor: grabbing;
    user-select: none;
    -webkit-user-select: none;
}

body.is-dragging .node {
    pointer-events: none;
}

body.is-dragging .node.selected-for-action {
    stroke: #3498db;
    stroke-width: 3;
}

/* --- UI Controls --- */
.role-btn {
    padding: 0.5rem 1rem;
    border-radius: 0.375rem;
    font-size: 0.875rem;
    font-weight: 500;
    background-color: #4A5568;
    color: #E2E8F0;
    transition: all 0.2s ease;
}

.role-btn:hover {
    background-color: #718096;
}

.role-btn.active {
    background-color: #3182CE;
    color: white;
    box-shadow: 0 0 0 2px #4A5568;
}

.node.path-selectable:hover {
    cursor: crosshair;
    stroke: #F6AD55;
    stroke-width: 4;
}

.admin-add-btn.active {
    background-color: #38b2ac;
    color: white;
    box-shadow: 0 0 0 2px #4a5568;
}

#importMapInput {
    display: none;
}

/* --- UI Component: Map Legend --- */
#mapLegendContent {
    transition: all 0.3s ease-in-out;
    overflow: hidden;
    max-height: 500px;
    opacity: 1;
    margin-top: 0.25rem;
}

#legendToggleIcon {
    transition: transform 0.3s ease;
}

#mapLegend.collapsed #mapLegendContent {
    max-height: 0;
    opacity: 0;
    margin-top: 0;
}

#mapLegend.collapsed #legendToggleIcon {
    transform: rotate(-90deg);
}

/* --- UI Component: Route Steps Panel --- */
.route-step {
    cursor: pointer;
    padding: 6px 10px;
    margin-bottom: 4px;
    border-radius: 4px;
    background-color: rgba(74, 85, 104, 0.3);
    transition: background-color 0.2s ease;
    font-size: 0.9rem;
}

.route-step:hover {
    background-color: #4A5568;
}

/* --- Animations --- */
@keyframes dash {
    from { stroke-dasharray: 10000; stroke-dashoffset: 10000; }
    to { stroke-dasharray: 10000; stroke-dashoffset: 0; }
}

@keyframes pulsing-stroke {
    0% { stroke-dashoffset: 0; }
    100% { stroke-dashoffset: -20; }
}

/* =========================================
   VISIBILITY CONTROL (The "Hiding" Logic)
   ========================================= */

/* 1. DEFAULT: HIDE Edges and Hallway Dots */
.edge {
    display: none !important;
}

.hallway-group {
    display: none !important;
}

/* 2. ADMIN MODE: SHOW Edges and Hallway Dots */
body.admin-mode .edge {
    display: block !important;
    opacity: 0.5; 
}

body.admin-mode .hallway-group {
    display: block !important;
}

/* 3. Ensure the Path is always on top and visible */
#path-container {
    display: block !important;
    z-index: 50;
    pointer-events: none;
}